h3[x > 5] <- 0
h4 <- (x-5)
h4[h4 < 5] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaC[1]+betaC[2]*x+betaC[3]*x^2+betaC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaC[1]+betaC[2]*x+, from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaC[1]+betaC[2]*x+betaC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[x > 5] <- 0
h3 <- x^3
h3[x > 5] <- 0
h4 <- (x-5)
h4[h4 < 5] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaC[1]+betaC[2]*x+betaC[3]*x^2+betaC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaC[1]+betaC[2]*x+betaC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[x > 5] <- 0
h3 <- x^3
h3[x > 5] <- 0
h4 <- (x-5)
h4[h4 < 5] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline',ymin=c(-100,100))
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline',ymin=c(-100,100))
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline',ymin=c(0,100))
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[x > 5] <- 0
h3 <- x^3
h3[x > 5] <- 0
h4 <- (x-5)
h4[h4 < 5] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline',ylim=c(0,100))
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline',ylim=c(-100,100))
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline',ylim=c(-100,100),xlim=c(-20,20))
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
source("C:/Users/Carlos de Cloet/Desktop/Topics in Advanced Statistics/Assignment/RCode/Assignment.R", echo=TRUE)
source("C:/Users/Carlos de Cloet/Desktop/Topics in Advanced Statistics/Assignment/RCode/Assignment.R", echo=TRUE)
curve(betaLC[1]+betaLC[2], from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
source("C:/Users/Carlos de Cloet/Desktop/Topics in Advanced Statistics/Assignment/RCode/Assignment.R", echo=TRUE)
curve(betaLC[1]+betaLC[2]*x+betlaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
source("C:/Users/Carlos de Cloet/Desktop/Topics in Advanced Statistics/Assignment/RCode/Assignment.R", echo=TRUE)
source("C:/Users/Carlos de Cloet/Desktop/Topics in Advanced Statistics/Assignment/RCode/Assignment.R", echo=TRUE)
source("C:/Users/Carlos de Cloet/Desktop/Topics in Advanced Statistics/Assignment/RCode/Assignment.R", echo=TRUE)
source("C:/Users/Carlos de Cloet/Desktop/Topics in Advanced Statistics/Assignment/RCode/Assignment.R", echo=TRUE)
source("C:/Users/Carlos de Cloet/Desktop/Topics in Advanced Statistics/Assignment/RCode/Assignment.R", echo=TRUE)
max(h2)
max(h3)
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[x > 5] <- 0
h3 <- x^3
h3[x > 5] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[x > 5] <- 0
h3 <- x^3
h3[x > 5] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[h2 > 25] <- 0
h3 <- x^3
h3[h3 > 125] <-0
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline',ylim=c(-5,5), xlim=c(4,6))
abline(v=5,lty=2,col='red')
curve(betaC[1]+betaC[2]*x+betaC[3]*x^2+betaC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaC[1]+betaC[2]*x+betaC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[h2 > 25] <- 0
h3 <- x^3
h3[h3 > 125] <-0
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaC[1]+betaC[2]*x+betaC[3]*x^2+betaC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaC[1]+betaC[2]*x+betaC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[h2 > 25] <- 0
h3 <- x^3
h3[h3 > 125] <-0
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
+betaLC[2]*x
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[h2 > 25] <- 0
h3 <- x^3
h3[h3 > 125] <-0
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h3 <- x^3
h3[h3 > 125] <-0
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h3,h4)
fit <- lm(y ~ 0+h0+h1+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
source("C:/Users/Carlos de Cloet/Desktop/Topics in Advanced Statistics/Assignment/RCode/Assignment.R", echo=TRUE)
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[h2 > 25] <- 0
h3 <- x^3
h3[h3 > 125] <-0
h4 <- (x-5)
h4[x < 5] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h2[h2 > 25] <- 0
h3 <- (x-5)^3
h3[h3 > 125] <-0
h4 <- (x-5)
h4[x < 5] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h2[h2 > 25] <- 0
h3 <- (x-5)^3
h3[h3 > 0] <-0
h4 <- (x-5)
h4[x < 5] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
p
p
p
p
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[h2 > 25] <- 25
h3 <- x^3
h3[h3 > 125] <-125
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[h2 > 25] <- 25
h3 <- x^3
h3[h3 > 125] <-125
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*5^2+betaLC[4]*5^3+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- x^2
h2[h2 > 25] <- 25
h3 <- x^3
h3[h3 > 125] <-125
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*5^2+betaLC[4]*5^3+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline', ylim=c(-5,5),xlim=c(4,6))
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*x^2+betaLC[4]*x^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*5^2+betaLC[4]*5^3+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
df2 <- data.frame(y,h0,h1,h2)
fit <- lm(y ~ 0+h0+h1+h2,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline', ylim=c(-5,5),xlim=c(4,6))
abline(v=5,lty=2,col='red')
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^3
df2 <- data.frame(y,h0,h1,h2)
fit <- lm(y ~ 0+h0+h1+h2,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline', ylim=c(-5,5),xlim=c(4,6))
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^3
df2 <- data.frame(y,h0,h1,h2)
fit <- lm(y ~ 0+h0+h1+h2,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h3 <- (x-5)^3
df2 <- data.frame(y,h0,h1,h2,h3)
fit <- lm(y ~ 0+h0+h1+h2+h3,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x-5)^2+betaLC[4]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h3 <- (x-5)^3
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x-5)^2+betaLC[4]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h3 <- (x-5)^3
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x5)^2+betaLC[4]*(x5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x)^2+betaLC[4]*(x)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x)^2+betaLC[4]*(x)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
-
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h3 <- (x-5)^3
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x-5)^2+betaLC[4]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h2[x > 5] <- 0
h3 <- (x-5)^3
h3[x > 5] <- 0
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x-5)^2+betaLC[4]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h2[x > 5] <- 0
h3 <- (x-5)^3
h3[x > 5] <- 0
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3)
fit <- lm(y ~ 0+h0+h1+h2+h3,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x-5)^2+betaLC[4]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h3 <- (x-5)^3
df2 <- data.frame(y,h0,h1,h2,h3)
fit <- lm(y ~ 0+h0+h1+h2+h3,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x-5)^2+betaLC[4]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x)^2+betaLC[4]*(x)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h3 <- (x-5)^3
df2 <- data.frame(y,h0,h1,h2,h3)
fit <- lm(y ~ 0+h0+h1+h2+h3,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x)^2+betaLC[4]*(x)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
-
-
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h3 <- (x-5)^3
df2 <- data.frame(y,h0,h1,h2,h3)
fit <- lm(y ~ 0+h0+h1+h2+h3,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x-5)^2+betaLC[4]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2/5
h3 <- (x-5)^3/5
df2 <- data.frame(y,h0,h1,h2,h3)
fit <- lm(y ~ 0+h0+h1+h2+h3,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x-5)^2+betaLC[4]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h3 <- (x-5)^3/5
df2 <- data.frame(y,h0,h1,h3)
fit <- lm(y ~ 0+h0+h1+h3,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h3 <- (x-5)^3
df2 <- data.frame(y,h0,h1,h3)
fit <- lm(y ~ 0+h0+h1+h3,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x, from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h3 <- (x-5)^3
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h3,h4)
fit <- lm(y ~ 0+h0+h1+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[4]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h3 <- (x-5)^3
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*(x-5)^2+betaLC[4]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
h0 <- rep(1,n)
h1 <- x
h2 <- (x-5)^2
h3 <- (x-5)^3
h4 <- (x-5)
h4[h4 < 0] <- 0
df2 <- data.frame(y,h0,h1,h2,h3,h4)
fit <- lm(y ~ 0+h0+h1+h2+h3+h4,df2)
betaLC <- coef(fit)
plot(x,y,pch=16,cex=.8,col='gray', main='Linear-Cubic Spline')
abline(v=5,lty=2,col='red')
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*(x-5)^2+betaLC[4]*(x-5)^3, from = min(x), to = 5, col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*(x-5)^2+betaLC[4]*(x-5)^3+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[3]*(5)^2+betaLC[4]*(5)^3+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[3]*(5)^2+betaLC[4]*(5)^3+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
curve(betaLC[1]+betaLC[2]*x+betaLC[5]*(x-5), from = 5, to = max(x), col='red',add=T,lwd=2)
